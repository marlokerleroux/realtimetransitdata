<!doctype html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <title>Projet Python</title>
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery-3.6.0.min.js"></script>
</head>

<body class="text-center">

  <script>
    $.getJSON("data/data.json", function (data) {

      $('#ville').change(function () {
        if ($('#ville').val() == "brest") {
          var select = $("<select></select>").attr("id", "arret").attr("name", "arret").attr("class", "form-control");
          $.each(data.brest, function (index, data) {
            select.append($("<option></option>").attr("value", data.Stop_name).text(data.Stop_name));
          });
          $("#container-arrets").html(select).append("<label>Choix de l'arrêt</label>");
        }
        if ($('#ville').val() == "caen") {
          var select = $("<select></select>").attr("id", "arret").attr("name", "arret").attr("class", "form-control");
          $.each(data.caen, function (index, data) {
            select.append($("<option></option>").attr("value", data.fields.stop_name).text(data.fields.stop_name));
          });
          $("#container-arrets").html(select).append("<label>Choix de l'arrêt</label>");
        }
        if ($('#ville').val() == "nantes") {
          var select = $("<select></select>").attr("id", "arret").attr("name", "arret").attr("class", "form-control");
          var previous = null;
          $.each(data.nantes, function (index, data) {
            if(previous != data.fields.stop_name){
              select.append($("<option></option>").attr("value", data.fields.parent_station).text(data.fields.stop_name));
            }
            previous = data.fields.stop_name;
          });
          $("#container-arrets").html(select).append("<label>Choix de l'arrêt</label>");
        }
        if ($('#ville').val() == "rennes") {
          var select = $("<select></select>").attr("id", "arret").attr("name", "arret").attr("class", "form-control");
          var previous = null;
          select.append($("<option disabled selected value> -- Aucun -- </option>"));
          $.each(data.rennes, function (index, data) {
            if(previous != data.fields.nom){
              select.append($("<option></option>").attr("value", data.fields.nom).text(data.fields.nom));
            }
            previous = data.fields.nom;
          });
          $("#container-arrets").html(select).append("<label>Choix de l'arrêt</label>");
        }
      });
    });
  </script>

  <div class="modal-dialog" role="document">
    <div class="modal-content rounded-5 shadow">
      <div class="modal-header p-5 pb-4 border-bottom-0">
        <h2 class="fw-bold mb-0">Horaires bus</h2>
      </div>

      <div class="modal-body p-5 pt-0">
        <form action="back.php" method="POST">
          <div class="form-floating mb-3">
            <select id="ville" name="ville" class="form-control">
              <option disabled selected value> -- Aucune -- </option>
              <option value="brest">Brest</option>
              <option value="caen">Caen</option>
              <option value="nantes">Nantes</option>
              <option value="rennes">Rennes</option>
            </select>
            <label>Choix de la ville</label>
          </div>
          <div id="container-arrets" class="form-floating mb-3"></div>
          <button class="w-100 mb-2 btn btn-lg rounded-4 btn-success" type="submit">Enregistrer</button>
          <button class="w-100 mb-2 btn btn-lg rounded-4 btn-danger" type="reset">Effacer</button>
        </form>
      </div>
    </div>
  </div>



</body>

</html>